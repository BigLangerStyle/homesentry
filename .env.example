# HomeSentry Configuration Template
# Copy this file to .env and update with your settings
# DO NOT commit .env file to Git (it contains secrets)

# ============================================================================
# Discord Alerts
# ============================================================================
# Create a webhook in Discord: Server Settings > Integrations > Webhooks
# Copy the webhook URL and paste it here
DISCORD_WEBHOOK_URL=https://discord.com/api/webhooks/YOUR_WEBHOOK_HERE

# Alert behavior configuration
ALERTS_ENABLED=true                # Enable/disable all Discord alerts
ALERT_COOLDOWN_MINUTES=30          # Minimum minutes between repeat alerts for same issue

# ============================================================================
# Polling Intervals (seconds)
# ============================================================================
# How often to collect system metrics and check services
POLL_INTERVAL=60

# How often to check SMART drive health (future feature)
SMART_POLL_INTERVAL=600

# ============================================================================
# Service URLs to Monitor
# ============================================================================
# Update these with your actual server IP and ports
# MediaServer IP: 192.168.1.8


# Service health check configuration
SERVICE_CHECK_TIMEOUT=10          # Seconds to wait for HTTP response
SERVICE_SLOW_THRESHOLD=3000       # Milliseconds - responses over this are marked as WARN

# Plex Media Server
PLEX_URL=http://192.168.1.8:32400

# Jellyfin Media Server
JELLYFIN_URL=http://192.168.1.8:8096

# Pi-hole DNS and Web Interface
PIHOLE_URL=http://192.168.1.8:80

# Home Assistant (optional - leave empty to disable)
HOMEASSISTANT_URL=http://192.168.1.8:8123

# qBittorrent (optional - leave empty to disable)
QBITTORRENT_URL=http://192.168.1.8:8080

# Tautulli - Plex monitoring and statistics (optional - leave empty to disable)
TAUTULLI_URL=http://192.168.1.8:8181

# ============================================================================
# Alert Thresholds
# ============================================================================
# CPU monitoring
CPU_WARN_THRESHOLD=80             # Warn when CPU usage > 80%
CPU_FAIL_THRESHOLD=95             # Critical when CPU usage > 95%

# Memory monitoring
MEMORY_WARN_THRESHOLD=85          # Warn when memory usage > 85%
MEMORY_FAIL_THRESHOLD=95          # Critical when memory usage > 95%

# Disk space warnings
DISK_WARN_PERCENT=85              # Warn when disk usage > 85%
DISK_FAIL_PERCENT=95              # Critical when disk usage > 95%
DISK_WARN_GB=50                   # Warn when free space < 50GB
DISK_FAIL_GB=10                   # Critical when free space < 10GB

# Service health monitoring
SERVICE_DOWN_WINDOW=120           # Wait 2 minutes before alerting on service down

# Container restart monitoring (future feature)
CONTAINER_RESTART_THRESHOLD=5     # Alert if container restarts > 5 times/hour

# ============================================================================
# Database
# ============================================================================
# Path to SQLite database file (relative to container)
DATABASE_PATH=/app/data/homesentry.db

# ============================================================================
# Logging
# ============================================================================
# Log level: DEBUG, INFO, WARNING, ERROR, CRITICAL
LOG_LEVEL=INFO

# ============================================================================
# Docker Container Monitoring
# ============================================================================
# Path to Docker socket (default: /var/run/docker.sock)
DOCKER_SOCKET_PATH=/var/run/docker.sock

# Enable/disable Docker container monitoring
DOCKER_COLLECTION_ENABLED=true

# Resource usage thresholds (optional, for future use)
DOCKER_CPU_WARN_THRESHOLD=80
DOCKER_CPU_FAIL_THRESHOLD=95
DOCKER_MEMORY_WARN_THRESHOLD=80
DOCKER_MEMORY_FAIL_THRESHOLD=95

# ============================================================================
# SMART Drive Health Monitoring
# ============================================================================
# Enable/disable SMART drive health monitoring
SMART_COLLECTION_ENABLED=true

# Comma-separated list of drives to monitor
# Update with your actual drive paths
SMART_DEVICES=/dev/sda,/dev/sdb,/dev/sdc,/dev/sdd

# Temperature thresholds (Celsius)
# HDDs: Normal = 20-40°C, Warning = 50°C+, Critical = 60°C+
# SSDs: Normal = 20-50°C, Warning = 60°C+, Critical = 70°C+
SMART_TEMP_WARN_THRESHOLD=50
SMART_TEMP_FAIL_THRESHOLD=60

# How often to collect SMART metrics (seconds)
# SMART data doesn't change rapidly, so 10 minutes is reasonable
SMART_POLL_INTERVAL=600

# ============================================================================
# RAID Array Monitoring
# ============================================================================
# Enable/disable RAID array monitoring
RAID_COLLECTION_ENABLED=true

# Comma-separated list of RAID arrays to monitor
# Leave empty to auto-detect all mdadm arrays
# Example: RAID_ARRAYS=md0,md1
RAID_ARRAYS=md0

# How often to collect RAID metrics (seconds)
# More frequent than SMART (2 minutes) since array degradation is critical
RAID_POLL_INTERVAL=120

# ============================================================================
# Maintenance Windows
# ============================================================================
# Suppress alerts during scheduled downtime to prevent notification spam.
# Format: HH:MM-HH:MM (24-hour time)
# 
# Per-service maintenance windows (service-specific):
# JELLYFIN_MAINTENANCE_WINDOW=03:00-03:15
# HOMEASSISTANT_MAINTENANCE_WINDOW=03:00-03:15
# QBITTORRENT_MAINTENANCE_WINDOW=05:15-05:30
# TAUTULLI_MAINTENANCE_WINDOW=03:00-03:15
# PLEX_MAINTENANCE_WINDOW=03:00-03:15
# PIHOLE_MAINTENANCE_WINDOW=05:00-05:15

# Global maintenance window (affects ALL services):
# GLOBAL_MAINTENANCE_WINDOW=05:00-05:15

# Optional: Day-of-week filtering (0=Monday, 6=Sunday)
# If not specified, maintenance windows apply every day
# JELLYFIN_MAINTENANCE_DAYS=0,1,2,3,4,5,6  # Every day (default)
# GLOBAL_MAINTENANCE_DAYS=6  # Sundays only

# Notes:
# - Midnight-spanning windows are supported (e.g., "23:45-00:15")
# - Recovery alerts (FAIL → OK) are sent after maintenance window ends
# - Critical infrastructure alerts (SMART, RAID) are never suppressed
# - All events are logged to database, only Discord notifications suppressed
# - Service names are case-insensitive (jellyfin = Jellyfin)

# ============================================================================
# Sleep Schedule & Morning Summary
# ============================================================================
# Complete alert suppression during sleep hours with optional morning digest.
# Different from maintenance windows - this provides multi-hour silence.

# Enable/disable sleep schedule
SLEEP_SCHEDULE_ENABLED=false

# Sleep hours (HH:MM format, 24-hour time)
# Example: 00:00-07:30 = midnight to 7:30 AM
# Supports midnight-spanning: 23:00-07:00
SLEEP_SCHEDULE_START=00:00
SLEEP_SCHEDULE_END=07:30

# Morning summary digest
# Send consolidated report of overnight activity at wake time
SLEEP_SUMMARY_ENABLED=true
SLEEP_SUMMARY_TIME=07:30

# Allow critical infrastructure alerts during sleep
# Set to true to get SMART/RAID alerts even during sleep hours
# Set to false for complete silence (recommended for most users)
SLEEP_ALLOW_CRITICAL_ALERTS=false

# Sleep Schedule vs Maintenance Windows:
# - Sleep schedule: Long periods (6-8 hours) for complete silence
#   * Suppresses ALL alerts including recovery alerts
#   * Optional morning summary shows overnight activity
#   * Takes precedence over maintenance windows
# 
# - Maintenance windows: Short periods (15-30 min) for known maintenance
#   * Recovery alerts still sent after window ends
#   * No summary digest
#   * More granular per-service control
#
# Both can be used together - sleep schedule takes priority during overlap

# Notes:
# - Sleep schedule suppresses ALL alerts (down, recovery, warnings)
# - Morning summary shows overnight activity in one consolidated report
# - Sleep schedule takes precedence over maintenance windows
# - Events are queued during sleep and cleared after summary sent
# - If summary is disabled, events are still logged but not sent
# - Summary shows "quiet night" message if no events occurred


# ============================================================================
# App Modules - Application-Specific Monitoring
# ============================================================================
# App modules provide deep integration with specific applications beyond
# basic container monitoring. Each module tracks app-specific metrics.

# ----------------------------------------------------------------------------
# Home Assistant Module
# ----------------------------------------------------------------------------
# Monitors Home Assistant smart home platform via REST API
# Tracks: entity count, automation count, API response time
#
# Get token from: Home Assistant → Profile → Security → Long-Lived Access Tokens
# Token should start with "eyJ" and be a long string (100+ characters)

# REQUIRED: Home Assistant API endpoint
# Use container name if running in Docker, or host IP
HOMEASSISTANT_API_URL=http://homeassistant:8123

# REQUIRED: Long-lived access token from Home Assistant
# Generate from: Profile → Security → Long-Lived Access Tokens → Create Token
HOMEASSISTANT_API_TOKEN=your_long_lived_access_token_here

# OPTIONAL: Alert thresholds for Home Assistant metrics
# Alert when total entities exceed these counts
HOMEASSISTANT_ENTITY_COUNT_WARN=500
HOMEASSISTANT_ENTITY_COUNT_FAIL=1000

# Alert when automation count exceeds these counts
HOMEASSISTANT_AUTOMATION_COUNT_WARN=100
HOMEASSISTANT_AUTOMATION_COUNT_FAIL=200

# OPTIONAL: API timeout in seconds (default: 10)
HOMEASSISTANT_TIMEOUT=10

# ----------------------------------------------------------------------------
# qBittorrent Module
# ----------------------------------------------------------------------------
# Monitors qBittorrent torrent client via Web API
# Tracks: active torrents, download/upload speeds, disk space, session stats
#
# Get credentials from: qBittorrent → Tools → Options → Web UI
# Default username is 'admin', password should be changed in qBittorrent settings

# REQUIRED: qBittorrent Web UI URL
# Use container name if running in Docker, or host IP
# Default port is usually 8080
QBITTORRENT_API_URL=http://qbittorrent:8080

# REQUIRED: Web UI authentication
# Default username is 'admin', change password in qBittorrent settings
QBITTORRENT_USERNAME=admin
QBITTORRENT_PASSWORD=adminadmin

# OPTIONAL: Alert thresholds for active torrents
# Warn when too many torrents are active (downloading/seeding)
QBITTORRENT_ACTIVE_TORRENTS_WARN=10
QBITTORRENT_ACTIVE_TORRENTS_FAIL=20

# OPTIONAL: Disk space thresholds (in GB)
# Warn when download directory is running low on space
QBITTORRENT_DISK_FREE_WARN_GB=100
QBITTORRENT_DISK_FREE_FAIL_GB=50

# OPTIONAL: API timeout in seconds (default: 10)
QBITTORRENT_TIMEOUT=10

# Notes:
# - Module auto-detects qBittorrent containers (qbittorrent, qbittorrent-vpn, qbittorrentvpn)
# - Tracks download/upload speeds (Mbps), active torrents, disk space
# - Session statistics show data transferred since qBittorrent started
# - Requires Web UI to be enabled in qBittorrent settings
# - Default credentials: admin/adminadmin (change in qBittorrent → Tools → Options → Web UI)

# ----------------------------------------------------------------------------
# Pi-hole Module
# ----------------------------------------------------------------------------
# Monitors Pi-hole DNS sinkhole for network-wide ad/tracker blocking
# Tracks: queries blocked, block percentage, active clients, blocklist size
#
# Works with both Docker and bare-metal Pi-hole installations
# Pi-hole v6+ requires API token authentication

# REQUIRED: Pi-hole Admin API URL
# Use your Pi-hole's IP address or hostname
# Port is usually 80 (HTTP) or 443 (HTTPS)
PIHOLE_API_URL=http://192.168.1.8:80

# REQUIRED for Pi-hole v6+: App password for API authentication
# Get from: Pi-hole web UI → Settings → API → Configure app password
# This is NOT your web UI login password - it's a separate app password
PIHOLE_API_PASSWORD=

# REQUIRED for bare-metal Pi-hole: Set to 'true' to run without Docker container
# Set this to 'true' if Pi-hole is installed as a systemd service (not in Docker)
PIHOLE_BARE_METAL=true

# OPTIONAL: Block percentage thresholds
# Warn if Pi-hole is blocking less than expected (might indicate issue)
# Low block percentage could mean:
#   - Pi-hole not being used as DNS server on all devices
#   - Blocklists need updating
#   - Most traffic is legitimate
PIHOLE_BLOCKED_PERCENT_WARN=10
PIHOLE_BLOCKED_PERCENT_FAIL=5

# OPTIONAL: Active clients threshold
# Warn if too many devices are using Pi-hole (capacity planning)
# PIHOLE_ACTIVE_CLIENTS_WARN=50

# OPTIONAL: API timeout in seconds (default: 10)
PIHOLE_TIMEOUT=10

# Notes:
# - Module auto-detects Pi-hole containers (pihole, pi-hole)
# - For bare-metal Pi-hole, set PIHOLE_BARE_METAL=true
# - Pi-hole v6+ requires API token (get from web UI → Settings → API)
# - Pi-hole v5 works without token (module tries both v5 and v6 endpoints)
# - Tracks queries blocked, block percentage, active clients, blocklist size
# - API endpoints: /api/stats/summary (v6) or /admin/api.php?summaryRaw (v5)
# - Works with both Docker and systemd Pi-hole installations

# ----------------------------------------------------------------------------
# Plex Media Server Module
# ----------------------------------------------------------------------------
# Monitors Plex Media Server streaming activity and library statistics
# Tracks: active streams, transcoding sessions, bandwidth, library size
#
# Works with both Docker and bare-metal Plex installations
# Requires X-Plex-Token for authentication

# REQUIRED: Plex Media Server URL
# Use your Plex server's IP address or hostname
# Default port is 32400
PLEX_API_URL=http://192.168.1.8:32400

# REQUIRED: X-Plex-Token for API authentication
# Get from: Plex Web → Account Settings → "Show" under Plex Token
# IMPORTANT: This token grants full access to your Plex account - keep it secure!
# Token is a long alphanumeric string (20 characters)
PLEX_API_TOKEN=your_plex_token_here

# REQUIRED for bare-metal Plex: Set to 'true' to run without Docker container
# Set this to 'true' if Plex is installed as a systemd service (not in Docker)
PLEX_BARE_METAL=true

# OPTIONAL: Transcoding session thresholds
# Transcoding is CPU-intensive - warn if too many concurrent transcodes
# Typical home server handles 2-3 hardware-accelerated transcodes comfortably
# Software transcoding is much more intensive (1-2 concurrent max)
PLEX_TRANSCODE_COUNT_WARN=3
PLEX_TRANSCODE_COUNT_FAIL=5

# OPTIONAL: API timeout in seconds (default: 10)
PLEX_TIMEOUT=10

# Notes:
# - Module auto-detects Plex containers (plex, plexmediaserver)
# - For bare-metal Plex (systemd), set PLEX_BARE_METAL=true
# - X-Plex-Token authentication required (get from Plex Web UI)
# - Tracks active streams, transcoding sessions, library size
# - API returns XML (not JSON) - module handles parsing
# - Direct Play has no performance impact, Transcoding is CPU-intensive
# - Hardware transcoding (Intel QuickSync, NVIDIA, etc.) reduces CPU load significantly
# - Metrics: active_streams, transcode_count, bandwidth_mbps, library_items, movie_count, tv_show_count
# - API endpoints: /status/sessions (streams), /library/sections (library stats)
# - Get X-Plex-Token: Plex Web UI → Account → Settings → "Show" under "Plex Token"
# - DO NOT commit your token to Git - keep .env file private!

# ----------------------------------------------------------------------------
# Jellyfin Media Server Module
# ----------------------------------------------------------------------------
# Monitors Jellyfin Media Server (secondary media server) streaming activity
# Tracks: active streams, transcoding sessions, active users, library size
#
# Jellyfin is an open-source alternative to Plex with similar functionality
# Works with Docker Jellyfin installations

# REQUIRED: Jellyfin Media Server URL
# Use your Jellyfin server's IP address or hostname
# Default port is 8096
JELLYFIN_API_URL=http://192.168.1.8:8096

# REQUIRED: Jellyfin API Key for authentication
# Generate from: Jellyfin Dashboard → API Keys → New API Key
# Give it a name like "HomeSentry" for easy identification
# This is NOT your login password - it's a separate API key
JELLYFIN_API_KEY=your_jellyfin_api_key_here

# OPTIONAL: Transcoding session thresholds
# Transcoding is CPU-intensive - warn if too many concurrent transcodes
# Typical home server handles 2-3 hardware-accelerated transcodes comfortably
# Software transcoding is much more intensive (1-2 concurrent max)
JELLYFIN_TRANSCODE_COUNT_WARN=3
JELLYFIN_TRANSCODE_COUNT_FAIL=5

# OPTIONAL: API timeout in seconds (default: 10)
JELLYFIN_TIMEOUT=10

# Notes:
# - Module auto-detects Jellyfin containers (jellyfin, jellyfin-server)
# - X-Emby-Token authentication (Jellyfin uses Emby protocol)
# - API returns JSON responses (simpler than Plex XML)
# - Tracks active streams, transcoding sessions, active users, library size
# - Direct Play has no performance impact, Transcoding is CPU-intensive
# - Hardware transcoding (Intel QuickSync, NVIDIA, etc.) reduces CPU load significantly
# - Metrics: active_streams, transcode_count, active_users, library_items, movie_count, series_count, episode_count
# - API endpoints: /Sessions (streams/users), /Items/Counts (library stats)
# - Get API key: Jellyfin Dashboard → API Keys → Create New API Key
# - DO NOT commit your API key to Git - keep .env file private!
